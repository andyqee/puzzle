<%inherit file='base.html'/>
<%block name="header">
</%block>

<%block name='body'>
    <div class="container">
        <form method ="GET" id="form">

    app：<select id="app_name" name="app_name">
    % for item in data['apps']:
        <option value="${item['app_name']}">${item['app_name']}</option>
    % endfor
    <option value="0">新增app</option>
    </select>
      <span style="margin-left: 20px;margin-right: 20px ;display: none;" id="new_app_span">
            app：<input type="text" style="width: 50px" name="new_app" id="new_app" disabled>
            (请输入新的app)
            </span>
            <input value="" name="version" id="version" type="hidden">
    &nbsp&nbsp
    platform:<select id="app_platform" name="app_platform" class="span1">
        <option value="ios">ios</option>
        <option value="android">android</option>
    </select>
    &nbsp&nbsp
    crash_count:<input type="text" class="span2" id="crash_count" name="crash_count">
            &nbsp&nbsp
    <button id="save" class="btn-info" type="button">保存</button>
     </form>
    <table class="table table-bordered">

        <tr>
            <td>app</td>
            <td>platform</td>
            <td>count</td>
            <td>图表</td>
        </tr>
        % if len(data['crash_limit']):
            % for item in data['crash_limit']:
            <tr>
                <td>${item['app_name']}</td>
                <td>${item['app_platform']}</td>
                <td>${item['crash_count']}</td>
                <td>
                    <a href="/monitor/detail?app_name=${item['app_name']}&app_platform=${item['app_platform']}" target="_blank">
                    <font color="#2e8bcc">详情</font>
                    </a>
                </td>
            </tr>
            % endfor
        % endif
    </table>
    </div>
        <script src="/static/js/jquery.js" type="text/javascript"></script>
<script type="text/javascript">
$(document).ready(function(){

    $('select#app_name').val("${data['params']['app_name']}");
    $('select#app_platform').val("${data['params']['app_platform']}");
    $('#crash_count').val("${data['params']['crash_count']}");

        $("#app_name").change(function(){
        var app_name = $("#app_name").val()
        if(app_name == 0){
            $("#new_app_span").show();
            $("#new_app").attr('disabled',false);
            $("#new_app").focus();
        }else{
            $("#new_app").attr('disabled',true);
            $("#new_app_span").hide();
        }
    });

    $('#save').click(function(){
        count = $('#crash_count').val();
        if(isNaN(count)){
            alert("请输入正确的crash_count");
        }else{
            form.submit();
        }
    });

});
</script>
</%block>
